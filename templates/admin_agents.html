{% extends "base.html" %}
{% block content %}

<h2>Administration des agents</h2>

<h3>CrÃ©er un agent</h3>

<form method="POST" action="/admin/agents/create" class="form">

<input name="nom" placeholder="Nom" required>
<input name="prenom" placeholder="PrÃ©nom" required>

<input type="date" name="naissance" required>

<select name="role">
    <option value="Plongeur">Plongeur</option>
    <option value="SAS">SAS</option>
    <option value="Admin">Admin</option>
</select>

<button>CrÃ©er agent</button>

<p style="font-size:12px;color:#666;margin-top:10px">
Login gÃ©nÃ©rÃ© automatiquement : premiÃ¨re lettre du prÃ©nom + nom<br>
Mot de passe Ã  dÃ©finir lors de la premiÃ¨re connexion.
</p>

</form>

<hr>

<h3>Liste des agents</h3>

<table>

<tr>
<th>Nom</th>
<th>PrÃ©nom</th>
<th>Naissance</th>
<th>Profil</th>
<th>Login</th>
<th>Ã‰tat</th>
<th>Actions</th>
</tr>

{% for a in agents %}
<tr>
<td>{{ a.nom }}</td>
<td>{{ a.prenom }}</td>
<td>{{ a.naissance }}</td>
<td>{{ a.role }}</td>
<td>{{ a.login }}</td>

<td>
{% if a.password == None %}
<span style="color:red">Ã€ activer</span>
{% else %}
Actif
{% endif %}
</td>

<td>

{% if a.login != session.login %}

<!-- RESET MOT DE PASSE -->
<form method="POST"
      action="/admin/agents/reset_password"
      onsubmit="return confirm('RÃ©initialiser le mot de passe de {{ a.prenom }} {{ a.nom }} ?');"
      style="display:inline">

<input type="hidden" name="login" value="{{ a.login }}">

<button type="submit" style="background:#1976d2;color:white">
ğŸ”‘ Reset
</button>

</form>

<!-- SUPPRIMER -->
<form method="POST"
      action="/admin/agents/delete"
      onsubmit="return confirm('Supprimer dÃ©finitivement {{ a.prenom }} {{ a.nom }} ?');"
      style="display:inline">

<input type="hidden" name="login" value="{{ a.login }}">

<button type="submit" style="background:#c62828;color:white">
ğŸ—‘ Supprimer
</button>

</form>

{% else %}
â€”
{% endif %}

</td>

</tr>
{% endfor %}

</table>

{% endblock %}
